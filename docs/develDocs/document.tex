\documentclass[A4,12pt, utf8, landscape]{article}
\usepackage{tikz}
\usepackage[
    backend=biber,
    style=authoryear-icomp,
    sortlocale=de_DE,
    natbib=true,
    url=false, 
    doi=true,
    eprint=false
]{biblatex}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{tikz}
\usepackage{todonotes}

\newcommand{\tinytodo}[2][]
   {\todo[caption={#2}, size=\small, #1]{\renewcommand{\baselinestretch}{0.5}\selectfont#2\par}}

\colorlet{punct}{red!60!black}
\definecolor{background}{HTML}{EEEEEE}
\definecolor{delim}{RGB}{20,105,176}
\colorlet{numb}{magenta!60!black}

\lstdefinelanguage{json}{
    basicstyle=\normalfont\ttfamily,
    % numbers=left,
    % numberstyle=\scriptsize,
    % stepnumber=1,
    % numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{background},
    literate=
     *{0}{{{\color{numb}0}}}{1}
      {1}{{{\color{numb}1}}}{1}
      {2}{{{\color{numb}2}}}{1}
      {3}{{{\color{numb}3}}}{1}
      {4}{{{\color{numb}4}}}{1}
      {5}{{{\color{numb}5}}}{1}
      {6}{{{\color{numb}6}}}{1}
      {7}{{{\color{numb}7}}}{1}
      {8}{{{\color{numb}8}}}{1}
      {9}{{{\color{numb}9}}}{1}
      {:}{{{\color{punct}{:}}}}{1}
      {,}{{{\color{punct}{,}}}}{1}
      {\{}{{{\color{delim}{\{}}}}{1}
      {\}}{{{\color{delim}{\}}}}}{1}
      {[}{{{\color{delim}{[}}}}{1}
      {]}{{{\color{delim}{]}}}}{1},
}
% \addbibresource{linked.bib}


\title{emuLVC - Stucture of the angularjs app}
\author{Raphael Winkelmann}
\date{\today}
\begin{document}
  % \maketitle



\begin{figure}[h]
  \tikzstyle{rootscope}=[rectangle, fill=black!50, thick,
                 inner sep=0.1cm, rounded corners]
  \tikzstyle{ctrl}=[rectangle, fill=red!50, thick,
                 inner sep=0.1cm, rounded corners]
  \tikzstyle{service}=[rectangle, fill=green!50, thick,
                 inner sep=0.1cm]
  \tikzstyle{directive}=[rectangle, fill=blue!50, thick,
                 inner sep=0.1cm, rounded corners]

  \tikzstyle{jso}=[rectangle, fill=yellow, thick,
                 inner sep=0.1cm]


  \begin{tikzpicture}
  \node (rootscope) at ( 0, 7) [rootscope] {\small{rootscope}};

    \node (colorServ) at ( -4, 0) [service] {\small{Colorproviderservice}};

    \node (mainCtrl) at ( 0, 5) [ctrl] {\small{mainCtl}};
    \node (viewState) at ( -4, 5) [service] {\small{viewState}};
    \node (ioHandler) at ( 4, 6) [service] {\small{Iohandlerservice}};
    \node (soundHandler) at ( 4, 5) [service] {\small{Soundhandlerservice}};
      \node (SSFFparser) at ( 7, 7.5) [service] {\small{ssffparserservice}};
      \node (TextGridParser) at ( 7, 7) [service] {\small{TGParser}};
      \node (labFileParser) at ( 7, 6.5) [service] {\small{labParser}};
      \node (Dropbox) at ( 7, 6) [service] {\small{DBHandler}};
      \node (Socket) at ( 7, 5.5) [service] {\small{Sockethandler}};


    \node (keys) at ( 0, 4) [ctrl] {\small{handleglobalkeys}};

    % oscispec ctrl
    \draw (-1, 3) rectangle (7, -1.5);

    \node (osciSpecCtrl) at ( 0, 3) [ctrl] {\small{handlespectosciCtrl}};

    \node (spect) at ( 1, 2) [directive] {\small{$<$spectrogram$>$}};

          \node (canspect) at (4 , 1) [directive] {\small{$<$canvas handlemouseinspect$>$}};
    
    \node (osci) at ( 1, 0) [directive] {\small{$<$oscii$>$}};

          \node (canosci) at (4 , -1) [directive] {\small{$<$canvas handlemouseinosci$>$}};

    % tiers
    \draw (-1, -2) rectangle (7, -4.5);
    \node (ssffData) at ( -4, 3) [jso] {\small{ssffData(model)}};
    \node (model) at ( -4, -2) [jso] {\small{tierInfos(model)}};
    \node (tierCtrl) at ( 0, -2) [ctrl] {\small{handletiersCtl}};

    \node (tier) at ( 1, -3) [directive] {\small{$<$tier$>$}};

          \node (cantier) at (4 , -4) [directive] {\small{$<$canvas handlemouseintier$>$}};

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %connections
    \draw [-] (mainCtrl) -- (keys);
    \draw [-] (keys) -- (osciSpecCtrl);
    \draw [-] (osciSpecCtrl.west) -- (tierCtrl.west);
    \draw [<->] (osciSpecCtrl.west) -- (ssffData);
    \draw [<->] (tierCtrl.west) -- (model);

    \draw [->, dotted] (ioHandler) -- (mainCtrl);
    \draw [->, dotted] (soundHandler) -- (mainCtrl);

    \draw [<-, dotted] (ioHandler) -- (SSFFparser);
    \draw [<-, dotted] (ioHandler) -- (TextGridParser);
    \draw [<-, dotted] (ioHandler) -- (labFileParser);
    \draw [<-, dotted] (ioHandler) -- (Dropbox);
    \draw [<-, dotted] (ioHandler) -- (Socket);

    %viewstate
    \draw [->, dotted] (viewState) -- (mainCtrl);
    \draw [->, dotted] (viewState) -- (osciSpecCtrl);
    \draw [->, dotted] (viewState) -- (tierCtrl.west);

    %colorproviderservice
    \draw [->, dotted] (colorServ) -- (osciSpecCtrl.west);
    \draw [->, dotted] (colorServ) -- (tierCtrl.west);

  \end{tikzpicture}
\end{figure}



\begin{lstlisting}[caption=internal label representation, label=ilr, language=json,firstnumber=1]
{
  "labelfileurls": [
    "file:/path/to/msajc003.TextGrid"
  ],
  "tiers": [
  {"TierName": "Phonetic",
    "type": "seg",
    "events": [
      {"label": "", "startSample": 0, "sampleDur": 8267}, 
      {"label": "V", "startSample": 8268, "sampleDur": 3064}, 
      {"label": "m", "startSample": 11333, "sampleDur": 3670}, 
      ...
    ]
  }
}
\end{lstlisting}

\begin{lstlisting}[caption=internal derived signal representation,label=idsr, language=json,firstnumber=1]
{
  "signalurl": "file:/path/to/msajc003.fms",
  "names" = ["fm", "bw"],
  "sampleRate" = 200,
  "origFreq" = 0,
  "startTime" = 0.0025,
  "startRecord" = 1,
  "endRecord" = 581, //first 3 shown
  "fm" = [[0, 1042, 2072, 3170],
          [0, 1260, 2122, 3118],
          [0, 1339, 2293, 3258],
          ...],
  "bw" = [[0, 886, 371, 890],
         [0, 724, 567, 826],
         [0, 410, 664, 740],
          ...]
}
\end{lstlisting}

% \printbibliography

\end{document}